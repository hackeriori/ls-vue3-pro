import{k as A,b as pe,l as Be,m as Ce,u as fe,j as ee,n as te,d as _e,c as xe}from"./base-Cu9M98Mf.js";import{u as be,d as ue,t as he,E as Fe}from"./el-scrollbar-CU9sRXL0.js";import{e as ye,g as Ve,h as Ne,i as De,m as Re,E as D,j as ze,p as $e,k as ne,n as Ke,l as Le,d as Me}from"./ExampleBox-C_i4eZW2.js";import{M as ce,d as O,j as F,J as Oe,c as k,l as re,h as ge,V as Ue,a as T,o as c,z as de,E as w,f as B,u as t,H as W,B as E,k as M,w as S,y as g,W as Ze,C as ae,m as le,A as N,G,t as ie,D as je,n as Ge,X as me}from"./index-B-ef8-WX.js";import{i as Y,U as x,I as $,C as q,E as We,b as Ye,a as qe}from"./validator-SW_bFDqq.js";import{_ as Ie,w as we}from"./install-BqcjuNST.js";const He=100,Je=600,ve={beforeMount(r,d){const o=d.value,{interval:l=He,delay:m=Je}=ce(o)?{}:o;let v,n;const s=()=>ce(o)?o():o.handler(),p=()=>{n&&(clearTimeout(n),n=void 0),v&&(clearInterval(v),v=void 0)};r.addEventListener("mousedown",P=>{P.button===0&&(p(),s(),document.addEventListener("mouseup",()=>p(),{once:!0}),n=setTimeout(()=>{v=setInterval(()=>{s()},l)},m))})}},Xe=pe({id:{type:String,default:void 0},step:{type:Number,default:1},stepStrictly:Boolean,max:{type:Number,default:Number.POSITIVE_INFINITY},min:{type:Number,default:Number.NEGATIVE_INFINITY},modelValue:Number,readonly:Boolean,disabled:Boolean,size:Be,controls:{type:Boolean,default:!0},controlsPosition:{type:String,default:"",values:["","right"]},valueOnClear:{type:[String,Number,null],validator:r=>r===null||A(r)||["min","max"].includes(r),default:null},name:String,placeholder:String,precision:{type:Number,validator:r=>r>=0&&r===Number.parseInt(`${r}`,10)},validateEvent:{type:Boolean,default:!0},...be(["ariaLabel"])}),Qe={[q]:(r,d)=>d!==r,blur:r=>r instanceof FocusEvent,focus:r=>r instanceof FocusEvent,[$]:r=>A(r)||Y(r),[x]:r=>A(r)||Y(r)},en=O({name:"ElInputNumber"}),nn=O({...en,props:Xe,emits:Qe,setup(r,{expose:d,emit:o}){const l=r,{t:m}=Ce(),v=fe("input-number"),n=F(),s=Oe({currentValue:l.modelValue,userInput:null}),{formItem:p}=ye(),P=k(()=>A(l.modelValue)&&l.modelValue<=l.min),f=k(()=>A(l.modelValue)&&l.modelValue>=l.max),U=k(()=>{const e=b(l.step);return ee(l.precision)?Math.max(b(l.modelValue),e):(e>l.precision,l.precision)}),C=k(()=>l.controls&&l.controlsPosition==="right"),H=Ve(),R=Ne(),Z=k(()=>{if(s.userInput!==null)return s.userInput;let e=s.currentValue;if(Y(e))return"";if(A(e)){if(Number.isNaN(e))return"";ee(l.precision)||(e=e.toFixed(l.precision))}return e}),K=(e,i)=>{if(ee(i)&&(i=U.value),i===0)return Math.round(e);let u=String(e);const h=u.indexOf(".");if(h===-1||!u.replace(".","").split("")[h+i])return e;const X=u.length;return u.charAt(X-1)==="5"&&(u=`${u.slice(0,Math.max(0,X-1))}6`),Number.parseFloat(Number(u).toFixed(i))},b=e=>{if(Y(e))return 0;const i=e.toString(),u=i.indexOf(".");let h=0;return u!==-1&&(h=i.length-u-1),h},z=(e,i=1)=>A(e)?K(e+l.step*i):s.currentValue,L=()=>{if(l.readonly||R.value||f.value)return;const e=Number(Z.value)||0,i=z(e);V(i),o($,s.currentValue),se()},j=()=>{if(l.readonly||R.value||P.value)return;const e=Number(Z.value)||0,i=z(e,-1);V(i),o($,s.currentValue),se()},a=(e,i)=>{const{max:u,min:h,step:y,precision:_,stepStrictly:X,valueOnClear:Q}=l;u<h&&he("InputNumber","min should not be greater than max.");let I=Number(e);if(Y(e)||Number.isNaN(I))return null;if(e===""){if(Q===null)return null;I=le(Q)?{min:h,max:u}[Q]:Q}return X&&(I=K(Math.round(I/y)*y,_),I!==e&&i&&o(x,I)),ee(_)||(I=K(I,_)),(I>u||I<h)&&(I=I>u?u:h,i&&o(x,I)),I},V=(e,i=!0)=>{var u;const h=s.currentValue,y=a(e);if(!i){o(x,y);return}h===y&&e||(s.userInput=null,o(x,y),h!==y&&o(q,y,h),l.validateEvent&&((u=p?.validate)==null||u.call(p,"change").catch(_=>ue())),s.currentValue=y)},oe=e=>{s.userInput=e;const i=e===""?null:Number(e);o($,i),V(i,!1)},J=e=>{const i=e!==""?Number(e):"";(A(i)&&!Number.isNaN(i)||e==="")&&V(i),se(),s.userInput=null},ke=()=>{var e,i;(i=(e=n.value)==null?void 0:e.focus)==null||i.call(e)},Se=()=>{var e,i;(i=(e=n.value)==null?void 0:e.blur)==null||i.call(e)},Te=e=>{o("focus",e)},Ae=e=>{var i,u;s.userInput=null,Ye()&&s.currentValue===null&&((i=n.value)!=null&&i.input)&&(n.value.input.value=""),o("blur",e),l.validateEvent&&((u=p?.validate)==null||u.call(p,"blur").catch(h=>ue()))},se=()=>{s.currentValue!==l.modelValue&&(s.currentValue=l.modelValue)},Pe=e=>{document.activeElement===e.target&&e.preventDefault()};return re(()=>l.modelValue,(e,i)=>{const u=a(e,!0);s.userInput===null&&u!==i&&(s.currentValue=u)},{immediate:!0}),ge(()=>{var e;const{min:i,max:u,modelValue:h}=l,y=(e=n.value)==null?void 0:e.input;if(y.setAttribute("role","spinbutton"),Number.isFinite(u)?y.setAttribute("aria-valuemax",String(u)):y.removeAttribute("aria-valuemax"),Number.isFinite(i)?y.setAttribute("aria-valuemin",String(i)):y.removeAttribute("aria-valuemin"),y.setAttribute("aria-valuenow",s.currentValue||s.currentValue===0?String(s.currentValue):""),y.setAttribute("aria-disabled",String(R.value)),!A(h)&&h!=null){let _=Number(h);Number.isNaN(_)&&(_=null),o(x,_)}y.addEventListener("wheel",Pe,{passive:!1})}),Ue(()=>{var e,i;const u=(e=n.value)==null?void 0:e.input;u?.setAttribute("aria-valuenow",`${(i=s.currentValue)!=null?i:""}`)}),d({focus:ke,blur:Se}),(e,i)=>(c(),T("div",{class:E([t(v).b(),t(v).m(t(H)),t(v).is("disabled",t(R)),t(v).is("without-controls",!e.controls),t(v).is("controls-right",t(C))]),onDragstart:ae(()=>{},["prevent"])},[e.controls?de((c(),T("span",{key:0,role:"button","aria-label":t(m)("el.inputNumber.decrease"),class:E([t(v).e("decrease"),t(v).is("disabled",t(P))]),onKeydown:W(j,["enter"])},[M(e.$slots,"decrease-icon",{},()=>[B(t(D),null,{default:S(()=>[t(C)?(c(),g(t(De),{key:0})):(c(),g(t(Re),{key:1}))]),_:1})])],42,["aria-label","onKeydown"])),[[t(ve),j]]):w("v-if",!0),e.controls?de((c(),T("span",{key:1,role:"button","aria-label":t(m)("el.inputNumber.increase"),class:E([t(v).e("increase"),t(v).is("disabled",t(f))]),onKeydown:W(L,["enter"])},[M(e.$slots,"increase-icon",{},()=>[B(t(D),null,{default:S(()=>[t(C)?(c(),g(t(ze),{key:0})):(c(),g(t($e),{key:1}))]),_:1})])],42,["aria-label","onKeydown"])),[[t(ve),L]]):w("v-if",!0),B(t(We),{id:e.id,ref_key:"input",ref:n,type:"number",step:e.step,"model-value":t(Z),placeholder:e.placeholder,readonly:e.readonly,disabled:t(R),size:t(H),max:e.max,min:e.min,name:e.name,"aria-label":e.ariaLabel,"validate-event":!1,onKeydown:[W(ae(L,["prevent"]),["up"]),W(ae(j,["prevent"]),["down"])],onBlur:Ae,onFocus:Te,onInput:oe,onChange:J},Ze({_:2},[e.$slots.prefix?{name:"prefix",fn:S(()=>[M(e.$slots,"prefix")])}:void 0,e.$slots.suffix?{name:"suffix",fn:S(()=>[M(e.$slots,"suffix")])}:void 0]),1032,["id","step","model-value","placeholder","readonly","disabled","size","max","min","name","aria-label","onKeydown"])],42,["onDragstart"]))}});var tn=Ie(nn,[["__file","input-number.vue"]]);const an=we(tn),ln=pe({modelValue:{type:[Boolean,String,Number],default:!1},disabled:Boolean,loading:Boolean,size:{type:String,validator:qe},width:{type:[String,Number],default:""},inlinePrompt:Boolean,inactiveActionIcon:{type:ne},activeActionIcon:{type:ne},activeIcon:{type:ne},inactiveIcon:{type:ne},activeText:{type:String,default:""},inactiveText:{type:String,default:""},activeValue:{type:[Boolean,String,Number],default:!0},inactiveValue:{type:[Boolean,String,Number],default:!1},name:{type:String,default:""},validateEvent:{type:Boolean,default:!0},beforeChange:{type:_e(Function)},id:String,tabindex:{type:[String,Number]},...be(["ariaLabel"])}),rn={[x]:r=>te(r)||le(r)||A(r),[q]:r=>te(r)||le(r)||A(r),[$]:r=>te(r)||le(r)||A(r)},Ee="ElSwitch",on=O({name:Ee}),sn=O({...on,props:ln,emits:rn,setup(r,{expose:d,emit:o}){const l=r,{formItem:m}=ye(),v=Ve(),n=fe("switch"),{inputId:s}=Ke(l,{formItemContext:m}),p=Ne(k(()=>l.loading)),P=F(l.modelValue!==!1),f=F(),U=F(),C=k(()=>[n.b(),n.m(v.value),n.is("disabled",p.value),n.is("checked",b.value)]),H=k(()=>[n.e("label"),n.em("label","left"),n.is("active",!b.value)]),R=k(()=>[n.e("label"),n.em("label","right"),n.is("active",b.value)]),Z=k(()=>({width:xe(l.width)}));re(()=>l.modelValue,()=>{P.value=!0});const K=k(()=>P.value?l.modelValue:!1),b=k(()=>K.value===l.activeValue);[l.activeValue,l.inactiveValue].includes(K.value)||(o(x,l.inactiveValue),o(q,l.inactiveValue),o($,l.inactiveValue)),re(b,a=>{var V;f.value.checked=a,l.validateEvent&&((V=m?.validate)==null||V.call(m,"change").catch(oe=>ue()))});const z=()=>{const a=b.value?l.inactiveValue:l.activeValue;o(x,a),o(q,a),o($,a),Ge(()=>{f.value.checked=b.value})},L=()=>{if(p.value)return;const{beforeChange:a}=l;if(!a){z();return}const V=a();[me(V),te(V)].includes(!0)||he(Ee,"beforeChange must return type `Promise<boolean>` or `boolean`"),me(V)?V.then(J=>{J&&z()}).catch(J=>{}):V&&z()},j=()=>{var a,V;(V=(a=f.value)==null?void 0:a.focus)==null||V.call(a)};return ge(()=>{f.value.checked=b.value}),d({focus:j,checked:b}),(a,V)=>(c(),T("div",{class:E(t(C)),onClick:ae(L,["prevent"])},[N("input",{id:t(s),ref_key:"input",ref:f,class:E(t(n).e("input")),type:"checkbox",role:"switch","aria-checked":t(b),"aria-disabled":t(p),"aria-label":a.ariaLabel,name:a.name,"true-value":a.activeValue,"false-value":a.inactiveValue,disabled:t(p),tabindex:a.tabindex,onChange:z,onKeydown:W(L,["enter"])},null,42,["id","aria-checked","aria-disabled","aria-label","name","true-value","false-value","disabled","tabindex","onKeydown"]),!a.inlinePrompt&&(a.inactiveIcon||a.inactiveText)?(c(),T("span",{key:0,class:E(t(H))},[a.inactiveIcon?(c(),g(t(D),{key:0},{default:S(()=>[(c(),g(G(a.inactiveIcon)))]),_:1})):w("v-if",!0),!a.inactiveIcon&&a.inactiveText?(c(),T("span",{key:1,"aria-hidden":t(b)},ie(a.inactiveText),9,["aria-hidden"])):w("v-if",!0)],2)):w("v-if",!0),N("span",{ref_key:"core",ref:U,class:E(t(n).e("core")),style:je(t(Z))},[a.inlinePrompt?(c(),T("div",{key:0,class:E(t(n).e("inner"))},[a.activeIcon||a.inactiveIcon?(c(),g(t(D),{key:0,class:E(t(n).is("icon"))},{default:S(()=>[(c(),g(G(t(b)?a.activeIcon:a.inactiveIcon)))]),_:1},8,["class"])):a.activeText||a.inactiveText?(c(),T("span",{key:1,class:E(t(n).is("text")),"aria-hidden":!t(b)},ie(t(b)?a.activeText:a.inactiveText),11,["aria-hidden"])):w("v-if",!0)],2)):w("v-if",!0),N("div",{class:E(t(n).e("action"))},[a.loading?(c(),g(t(D),{key:0,class:E(t(n).is("loading"))},{default:S(()=>[B(t(Le))]),_:1},8,["class"])):t(b)?M(a.$slots,"active-action",{key:1},()=>[a.activeActionIcon?(c(),g(t(D),{key:0},{default:S(()=>[(c(),g(G(a.activeActionIcon)))]),_:1})):w("v-if",!0)]):t(b)?w("v-if",!0):M(a.$slots,"inactive-action",{key:2},()=>[a.inactiveActionIcon?(c(),g(t(D),{key:0},{default:S(()=>[(c(),g(G(a.inactiveActionIcon)))]),_:1})):w("v-if",!0)])],2)],6),!a.inlinePrompt&&(a.activeIcon||a.activeText)?(c(),T("span",{key:1,class:E(t(R))},[a.activeIcon?(c(),g(t(D),{key:0},{default:S(()=>[(c(),g(G(a.activeIcon)))]),_:1})):w("v-if",!0),!a.activeIcon&&a.activeText?(c(),T("span",{key:1,"aria-hidden":!t(b)},ie(a.activeText),9,["aria-hidden"])):w("v-if",!0)],2)):w("v-if",!0)],10,["onClick"]))}});var un=Ie(sn,[["__file","switch.vue"]]);const cn=we(un),dn=O({__name:"RollNumber",props:{number:{},fractionDigits:{default:0},duration:{default:300},trimRightZero:{type:Boolean,default:!0}},setup(r){const d=r,o=F(d.number),l=k(()=>{let n=o.value.toFixed(d.fractionDigits);return d.trimRightZero&&d.fractionDigits&&(n=n.replace(/\.0+/,"")),n});let m=null;re(()=>d.number,n=>v(n));function v(n){const s=performance.now(),p=o.value,P=n-p;m&&cancelAnimationFrame(m);function f(U){const C=U-s;if(C>0)if(C<d.duration)o.value=p+P*(C/d.duration);else{o.value=n,m=null;return}m=requestAnimationFrame(f)}m=requestAnimationFrame(f)}return(n,s)=>(c(),T("span",null,ie(l.value),1))}}),mn={class:"height100",style:{padding:"0.5em","box-sizing":"border-box"}},vn={class:"ls-text-line"},pn={class:"ls-text-line"},fn={class:"ls-text-line"},bn={class:"ls-text-line"},hn={class:"ls-text-line"},En=O({__name:"RollNumberTest",setup(r){const d=F(20),o=F(0),l=F(300),m=F(!0);return(v,n)=>{const s=an,p=cn,P=Fe;return c(),T("div",mn,[B(P,null,{default:S(()=>[n[10]||(n[10]=N("h1",null,"RollNumber是一个展示数字及数字间动画过渡的组件",-1)),B(Me,null,{code:S(()=>n[9]||(n[9]=[N("pre",null,`<div class="ls-text-line">
  <span>后台控制的数值</span>
  <el-input-number v-model="value" :step="20"></el-input-number>
</div>
<div class="ls-text-line">
  <span>小数位数</span>
  <el-input-number v-model="decimal" :min="0" :max="3"></el-input-number>
</div>
<div class="ls-text-line">
  <span>动画时间</span>
  <el-input-number v-model="duration" :min="0" :max="3000"></el-input-number>
</div>
<div class="ls-text-line">
  <span>移除小数后多余的0</span>
  <el-switch v-model="trimRightZero"></el-switch>
</div>
<div class="ls-text-line">
  <span>页面呈现的数值</span>
  <RollNumber style="color: red" :number="value" :fractionDigits="decimal" :duration="duration"
              :trim-right-zero="trimRightZero"></RollNumber>
</div>
<script setup lang="ts">
import ExampleBox from "../exampleBox/ExampleBox.vue";
import {ref} from "vue";
import RollNumber from "./RollNumber.vue";

const value = ref(20);
const decimal = ref(0);
const duration = ref(300);
const trimRightZero = ref(true);`,-1)])),default:S(()=>[N("div",vn,[n[4]||(n[4]=N("span",null,"后台控制的数值",-1)),B(s,{modelValue:d.value,"onUpdate:modelValue":n[0]||(n[0]=f=>d.value=f),step:20},null,8,["modelValue"])]),N("div",pn,[n[5]||(n[5]=N("span",null,"小数位数",-1)),B(s,{modelValue:o.value,"onUpdate:modelValue":n[1]||(n[1]=f=>o.value=f),min:0,max:3},null,8,["modelValue"])]),N("div",fn,[n[6]||(n[6]=N("span",null,"动画时间",-1)),B(s,{modelValue:l.value,"onUpdate:modelValue":n[2]||(n[2]=f=>l.value=f),min:0,max:3e3},null,8,["modelValue"])]),N("div",bn,[n[7]||(n[7]=N("span",null,"移除小数后多余的0",-1)),B(p,{modelValue:m.value,"onUpdate:modelValue":n[3]||(n[3]=f=>m.value=f)},null,8,["modelValue"])]),N("div",hn,[n[8]||(n[8]=N("span",null,"页面呈现的数值",-1)),B(dn,{style:{color:"red"},number:d.value,fractionDigits:o.value,duration:l.value,"trim-right-zero":m.value},null,8,["number","fractionDigits","duration","trim-right-zero"])])]),_:1})]),_:1})])}}});export{En as default};
